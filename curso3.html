<!DOCTYPE html><html lang="pt-BR"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Mapas Mentais Públicos</title><style>:root{--p:#1E90FF;--bg:#f4f4f9;--fg:#333}body{margin:0;font-family:Arial;background:var(--bg);color:var(--fg)}header{background:var(--p);color:#fff;padding:12px 20px;text-align:center}header h1{margin:0;font-size:1.8em}main{padding:20px}.card{background:#fff;border-radius:10px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06);margin-bottom:16px}.file-list{margin-top:20px}.file-item{display:flex;justify-content:space-between;align-items:center;padding:10px;background:#f0f0f0;border-radius:6px;margin-bottom:8px}.file-item a{text-decoration:none;color:var(--p)}.row{display:flex;gap:8px;align-items:center}.btn{cursor:pointer;padding:6px 12px;border-radius:6px;border:none;background:var(--p);color:#fff}</style></head><body><header><h1>Mapas Mentais Públicos</h1></header><main><div class="card"><h3>Enviar Mapa Mental</h3><input type="file" id="fileInput"><button class="btn" id="uploadBtn">Enviar</button></div><div class="card file-list" id="fileList"><h3>Mapas Disponíveis</h3></div><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><script>const SUPABASE_URL="https://nqhthypeljupfftlmwsz.supabase.co",SUPABASE_KEY="sb_publishable_Nzfhcwd_mFYlzJro3318-g_aX6vGjD1",supabase=supabase.createClient(SUPABASE_URL,SUPABASE_KEY);const fileList=document.getElementById("fileList");async function loadFiles(){try{const{data,error}=await supabase.from("mapas").select("id,nome,url,uploader_id").order("created_at",{ascending:false});if(error){console.error(error);return}fileList.innerHTML="<h3>Mapas Disponíveis</h3>";data.forEach(f=>{let div=document.createElement("div");div.className="file-item";let a=document.createElement("a");a.href=f.url;a.target="_blank";a.textContent=f.nome;div.appendChild(a);let btnDel=document.createElement("button");btnDel.textContent="Excluir";btnDel.className="btn";btnDel.onclick=async()=>{if(f.uploader_id!==localStorage.getItem("uploader_id")){alert("Somente quem postou pode excluir.");return}if(confirm("Excluir mapa?")){await supabase.from("mapas").delete().eq("id",f.id);await supabase.storage.from("mapas").remove([f.nome]);loadFiles();}};div.appendChild(btnDel);fileList.appendChild(div)})}catch(e){console.error(e)}}loadFiles();document.getElementById("uploadBtn").addEventListener("click",async()=>{const file=document.getElementById("fileInput").files[0];if(!file){alert("Selecione um arquivo");return}const fileName=Date.now()+"_"+file.name;try{await supabase.storage.from("mapas").upload(fileName,file);const uploader_id=localStorage.getItem("uploader_id")||crypto.randomUUID();localStorage.setItem("uploader_id",uploader_id);const {data,error}=await supabase.from("mapas").insert({nome:fileName,url:`https://nqhthypeljupfftlmwsz.supabase.co/storage/v1/object/public/mapas/${fileName}`,uploader_id});if(error)console.error(error);else{alert("Enviado com sucesso");loadFiles();}}catch(e){console.error(e)}});</script></main></body></html>