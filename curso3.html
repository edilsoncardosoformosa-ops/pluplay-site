<!DOCTYPE html><html lang="pt-BR"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Mapas Mentais Públicos</title><style>:root{--p:#1E90FF;--bg:#f4f4f9;--fg:#333}body{margin:0;font-family:Arial;background:var(--bg);color:var(--fg)}header{background:var(--p);color:#fff;padding:12px 20px;text-align:center}header h1{margin:0;font-size:1.8em}main{padding:20px}.card{background:#fff;border-radius:10px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06);margin-bottom:16px}.file-item{display:flex;justify-content:space-between;align-items:center;padding:10px;background:#f0f0f0;border-radius:6px;margin-bottom:8px}.file-item a{text-decoration:none;color:var(--p)}.btn{cursor:pointer;padding:6px 12px;border-radius:6px;border:none;background:var(--p);color:#fff}</style></head><body><header><h1>Mapas Mentais Públicos</h1></header><main><div class="card"><h3>Enviar Mapa Mental</h3><input type="file" id="fileInput"><button class="btn" id="uploadBtn">Enviar</button></div><div class="card" id="fileList"><h3>Mapas Disponíveis</h3></div><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><script>const SUPABASE_URL="https://nqhthypeljupfftlmwsz.supabase.co",SUPABASE_KEY="sb_publishable_Nzfhcwd_mFYlzJro3318-g_aX6vGjD1",supabase=supabase.createClient(SUPABASE_URL,SUPABASE_KEY),fileList=document.getElementById("fileList");async function sha256(t){const e=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(t=>t.toString(16).padStart(2,"0")).join("")}async function loadFiles(){const{data:e,error:n}=await supabase.from("mapas").select("id,nome,url,uploader_id").order("created_at",{ascending:!1});if(n){console.error(n);return}fileList.innerHTML="<h3>Mapas Disponíveis</h3>",e.forEach(e=>{let n=document.createElement("div");n.className="file-item";let a=document.createElement("a");a.href=e.url,a.target="_blank",a.textContent=e.nome,n.appendChild(a);let t=document.createElement("button");t.textContent="Excluir",t.className="btn",t.onclick=async()=>{const n=prompt("Digite sua senha para excluir");if(!n)return;const a=await sha256(n);if(a!==e.uploader_id){alert("Senha incorreta ou não é seu arquivo.");return}confirm("Excluir mapa?")&&(await supabase.from("mapas").delete().eq("id",e.id),await supabase.storage.from("mapas").remove([e.nome]),loadFiles())},n.appendChild(t),fileList.appendChild(n)})}loadFiles(),document.getElementById("uploadBtn").addEventListener("click",async()=>{const e=document.getElementById("fileInput").files[0];if(!e){alert("Selecione um arquivo");return}const n=prompt("Digite sua senha para envio");if(!n)return;const a=await sha256(n),t=Date.now()+"_"+e.name;await supabase.storage.from("mapas").upload(t,e);const{error:o}=await supabase.from("mapas").insert({nome:t,url:`${SUPABASE_URL}/storage/v1/object/public/mapas/${t}`,uploader_id:a});o?console.error(o):(alert("Enviado com sucesso"),loadFiles())});</script></main></body></html>