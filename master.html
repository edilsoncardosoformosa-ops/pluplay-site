<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Master Admin</title>
<style>
  :root{--primary:#1E90FF;--secondary:#FFA500;--bg:#f4f4f9;--fg:#333}
  body{font-family:Arial,Helvetica,sans-serif;margin:0;padding:0;background:var(--bg);color:var(--fg)}
  header{background:var(--primary);color:#fff;padding:12px;text-align:center;font-size:1.5em}
  .container{padding:12px;max-width:900px;margin:auto}
  h3{margin-top:24px}
  button{padding:4px 8px;margin:2px;cursor:pointer;border:none;border-radius:4px;background:var(--secondary);color:#fff}
  input,select,textarea{padding:4px;margin:2px;width:100%;box-sizing:border-box}
  .hidden{display:none}
  .card{border:1px solid #ccc;padding:8px;margin:4px;border-radius:6px;background:#fff}
  .row{display:flex;gap:8px;margin-top:4px}
  .muted{color:#666;font-size:0.9em}
</style>
</head>
<body>

<header>Master Admin Panel</header>
<div class="container">

<!-- ===== Users ===== -->
<h3>Gerenciar Usuários</h3>
<div>
  <input id="manualUserId" placeholder="ID do usuário">
  <input id="manualUserNote" placeholder="Observação">
  <button id="addManualUserBtn">Adicionar Usuário</button>
</div>
<ul id="userList"></ul>

<!-- ===== Quiz ===== -->
<h3>Gerenciar Questões</h3>
<div>
  <select id="filterTopic">
    <option value="">Todos os tópicos</option>
    <option value="Lport">Língua Portuguesa</option>
    <option value="ride">Raciocínio Lógico</option>
    <option value="Legisla">Legislação</option>
    <option value="TemaEdu">Temas Educacionais</option>
    <option value="Eduincl">Educação Inclusiva</option>
  </select>
  <input id="searchQuestion" placeholder="Buscar questão">
</div>
<div id="questionsList"></div>

<!-- ===== Adicionar Questão ===== -->
<h3>Adicionar Questão</h3>
<div>
  <select id="newTopic">
    <option value="Lport">Língua Portuguesa</option>
    <option value="ride">Raciocínio Lógico</option>
    <option value="Legisla">Legislação</option>
    <option value="TemaEdu">Temas Educacionais</option>
    <option value="Eduincl">Educação Inclusiva</option>
  </select>
  <input id="newQuestionText" placeholder="Pergunta">
  <input id="newQuestionAnswer" placeholder="Resposta (true/false)">
  <textarea id="newQuestionComment" placeholder="Comentário"></textarea>
  <button id="saveQuestionBtn">Salvar Questão</button>
</div>

<!-- ===== Adicionar Bloco ===== -->
<h3>Adicionar Bloco de Questões (JSON)</h3>
<div>
  <select id="newBlockTopic">
    <option value="Lport">Língua Portuguesa</option>
    <option value="ride">Raciocínio Lógico</option>
    <option value="Legisla">Legislação</option>
    <option value="TemaEdu">Temas Educacionais</option>
    <option value="Eduincl">Educação Inclusiva</option>
  </select>
  <textarea id="newBlockQuestions" placeholder='Uma questão por linha em JSON, ex: {"q":"Pergunta","a":true,"c":"Comentário"}'></textarea>
  <button id="saveBlockBtn">Salvar Bloco</button>
</div>

<!-- ===== Edit Modal ===== -->
<div id="editQuestionModal" class="hidden">
  <h3>Editar Questão</h3>
  <select id="editTopic">
    <option value="Lport">Língua Portuguesa</option>
    <option value="ride">Raciocínio Lógico</option>
    <option value="Legisla">Legislação</option>
    <option value="TemaEdu">Temas Educacionais</option>
    <option value="Eduincl">Educação Inclusiva</option>
  </select>
  <input id="editQuestionText" placeholder="Pergunta">
  <input id="editQuestionAnswer" placeholder="Resposta (true/false)">
  <textarea id="editQuestionComment" placeholder="Comentário"></textarea>
  <button id="saveEditBtn">Salvar Edição</button>
  <button onclick="hideEditModal()">Fechar</button>
</div>

</div>

<script>
let quizData={Lport:[],ride:[],Legisla:[],TemaEdu:[],Eduincl:[]};
let users=[];

function renderUserList(){
  const ul=document.getElementById('userList');
  ul.innerHTML='';
  users.forEach((u,i)=>{
    const li=document.createElement('li');
    li.textContent=`${u.id} - ${u.note||''}`;
    const btnDel=document.createElement('button');
    btnDel.textContent='❌';
    btnDel.style.marginLeft='8px';
    btnDel.onclick=()=>{ users.splice(i,1); renderUserList(); };
    li.appendChild(btnDel);
    ul.appendChild(li);
  });
}

function addManualUser(){
  const id=document.getElementById('manualUserId').value.trim();
  const note=document.getElementById('manualUserNote').value.trim();
  if(!id) return alert('Informe ID do usuário!');
  users.push({id,note});
  renderUserList();
  document.getElementById('manualUserId').value='';
  document.getElementById('manualUserNote').value='';
}
document.getElementById('addManualUserBtn').addEventListener('click',addManualUser);

function renderQuestionsList(){
  const topic=document.getElementById('filterTopic').value;
  const search=document.getElementById('searchQuestion').value.toLowerCase();
  const container=document.getElementById('questionsList');
  container.innerHTML='';
  const keys=topic? [topic]:Object.keys(quizData);
  keys.forEach(k=>{
    quizData[k].forEach((q,i)=>{
      if(search && !q.q.toLowerCase().includes(search)) return;
      const div=document.createElement('div');
      div.className='card';
      div.innerHTML=`<strong>[${k}]</strong> ${q.q} <br><span class="muted">${q.c}</span>`;
      const btnEdit=document.createElement('button'); btnEdit.textContent='✏️'; btnEdit.onclick=()=>openEditModal(k,i);
      const btnDel=document.createElement('button'); btnDel.textContent='❌'; btnDel.onclick=()=>{ quizData[k].splice(i,1); renderQuestionsList(); };
      const row=document.createElement('div'); row.className='row'; row.appendChild(btnEdit); row.appendChild(btnDel);
      div.appendChild(row);
      container.appendChild(div);
    });
  });
}
document.getElementById('filterTopic').addEventListener('change',renderQuestionsList);
document.getElementById('searchQuestion').addEventListener('input',renderQuestionsList);

document.getElementById('saveQuestionBtn').addEventListener('click',()=>{
  const t=document.getElementById('newTopic').value;
  const q=document.getElementById('newQuestionText').value.trim();
  const c=document.getElementById('newQuestionComment').value.trim();
  const a=document.getElementById('newQuestionAnswer').value==='true';
  if(!q) return alert('Informe a pergunta!');
  quizData[t].push({q,a,c});
  document.getElementById('newQuestionText').value=''; document.getElementById('newQuestionComment').value='';
  renderQuestionsList();
});

document.getElementById('saveBlockBtn').addEventListener('click',()=>{
  const t=document.getElementById('newBlockTopic').value;
  const text=document.getElementById('newBlockQuestions').value.trim();
  if(!text) return alert('Informe questões em formato JSON!');
  try{
    const arr=text.split('\n').map(line=>line.trim()).filter(Boolean).map(line=>JSON.parse(line));
    quizData[t].push(...arr);
    document.getElementById('newBlockQuestions').value='';
    renderQuestionsList();
  }catch(e){ alert('Formato JSON inválido!'); }
});

let currentEdit={topic:null,index:null};
function openEditModal(topic,index){
  currentEdit={topic,index};
  const q=quizData[topic][index];
  document.getElementById('editTopic').value=topic;
  document.getElementById('editQuestionText').value=q.q;
  document.getElementById('editQuestionComment').value=q.c;
  document.getElementById('editQuestionAnswer').value=q.a;
  document.getElementById('editQuestionModal').classList.remove('hidden');
}
function hideEditModal(){document.getElementById('editQuestionModal').classList.add('hidden');}
document.getElementById('saveEditBtn').addEventListener('click',()=>{
  const t=document.getElementById('editTopic').value;
  const q=document.getElementById('editQuestionText').value.trim();
  const c=document.getElementById('editQuestionComment').value.trim();
  const a=document.getElementById('editQuestionAnswer').value==='true';
  if(!q) return alert('Informe a pergunta!');
  if(currentEdit.topic!==t){
    quizData[currentEdit.topic].splice(currentEdit.index,1);
    quizData[t].push({q,a,c});
  }else{
    quizData[t][currentEdit.index]={q,a,c};
  }
  hideEditModal();
  renderQuestionsList();
});
</script>

</body>
</html>