<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Master Admin</title>
<style>
body { font-family: Arial, sans-serif; background:#f4f4f9; color:#333; padding:20px; }
h1 { color:#1E90FF; }
button { padding:8px 12px; margin:4px; cursor:pointer; border-radius:4px; border:none; background:#1E90FF; color:white; }
button.danger { background:#FF4500; }
section { margin-top:20px; }
#questionsList, #blocksList, #usersList { margin-top:10px; }
.card { background:white; padding:10px; margin:5px 0; border-radius:6px; box-shadow:0 1px 3px rgba(0,0,0,0.1); }
</style>
<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

const supabaseUrl = 'https://nqhthypeljupfftlmwsz.supabase.co'
const supabaseKey = 'sb_publishable_Nzfhcwd_mFYlzJro3318-g_aX6vGjD1'
const supabase = createClient(supabaseUrl, supabaseKey)

// =====================
// Funções principais
// =====================

// Listar blocos
async function listarBlocos() {
  const { data, error } = await supabase.from('blocks').select('*')
  const container = document.getElementById('blocksList')
  container.innerHTML = ''
  if (error) return console.error(error)
  data.forEach(b => {
    const div = document.createElement('div')
    div.className = 'card'
    div.textContent = b.topic
    container.appendChild(div)
  })
}

// Listar usuários
async function listarUsuarios() {
  const { data, error } = await supabase.from('users').select('*')
  const container = document.getElementById('usersList')
  container.innerHTML = ''
  if (error) return console.error(error)
  data.forEach(u => {
    const div = document.createElement('div')
    div.className = 'card'
    div.textContent = `${u.name} - ${u.note || ''}`
    container.appendChild(div)
  })
}

// Listar questões
async function listarQuestoes() {
  const { data, error } = await supabase.from('questions').select('*')
  const container = document.getElementById('questionsList')
  container.innerHTML = ''
  if (error) return console.error(error)
  data.forEach(q => {
    const div = document.createElement('div')
    div.className = 'card'
    div.textContent = `[${q.topic}] ${q.question} (${q.answer ? '✔️' : '❌'})`
    container.appendChild(div)
  })
}

// Adicionar usuário
async function adicionarUsuario() {
  const nome = prompt('Nome do usuário:')
  const nota = prompt('Nota/Observação (opcional):')
  if (!nome) return
  const { data, error } = await supabase.from('users').insert([{ name: nome, note: nota }])
  if (error) return console.error(error)
  listarUsuarios()
}

// =====================
// Inicialização
// =====================
document.addEventListener('DOMContentLoaded', () => {
  listarBlocos()
  listarUsuarios()
  listarQuestoes()
  document.getElementById('btnAddUser').onclick = adicionarUsuario
})
</script>
</head>
<body>
<h1>Master Admin</h1>

<section>
  <h2>Blocos</h2>
  <div id="blocksList"></div>
</section>

<section>
  <h2>Usuários</h2>
  <button id="btnAddUser">Adicionar Usuário</button>
  <div id="usersList"></div>
</section>

<section>
  <h2>Questões</h2>
  <div id="questionsList"></div>
</section>
</body>
</html>
