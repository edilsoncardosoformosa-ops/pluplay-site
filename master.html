<!DOCTYPE html><html lang="pt-BR"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Master Admin</title><style>
body{font-family:Arial,Helvetica,sans-serif;margin:0;padding:0;background:#f4f4f9;color:#333}
header{background:#1E90FF;color:#fff;padding:12px;text-align:center;cursor:pointer}
nav{display:flex;justify-content:center;gap:12px;background:#eee;padding:10px}
nav button{padding:8px 14px;border:none;border-radius:8px;background:#1E90FF;color:#fff;cursor:pointer}
nav button:hover{background:#104E8B}
section{display:none;padding:16px}
.active{display:block}
table{border-collapse:collapse;width:100%;margin-top:12px}
table,th,td{border:1px solid #ccc}
th,td{padding:8px;text-align:left}
input,select,textarea{padding:6px;margin:4px;width:95%}
#questionForm,#blockForm,#userForm{max-width:600px;margin:auto}
</style></head><body>
<header ondblclick="showSection('manageQuestions')">Painel Master</header>
<nav>
<button onclick="showSection('manageQuestions')">Gerenciar Questões</button>
<button onclick="showSection('addQuestion')">Adicionar Questão</button>
<button onclick="showSection('addBlock')">Adicionar Bloco</button>
<button onclick="showSection('manageUsers')">Gerenciar Usuários</button>
</nav>
<section id="manageQuestions">
<h2>Gerenciar Questões</h2>
<input type="text" id="searchQuestion" placeholder="Pesquisar questão...">
<select id="filterBlock"></select>
<div id="questionsList"></div>
</section>
<section id="addQuestion">
<h2>Adicionar Questão</h2>
<form id="questionForm">
<label>Bloco:</label><select id="questionBlock"></select>
<label>Enunciado:</label><textarea id="questionText"></textarea>
<label>Comentário:</label><textarea id="questionComment"></textarea>
<label>Resposta Correta:</label><select id="questionAnswer"><option value="true">Verdadeiro</option><option value="false">Falso</option></select>
<button type="submit">Salvar Questão</button>
</form>
</section>
<section id="addBlock">
<h2>Adicionar Bloco</h2>
<form id="blockForm">
<label>Nome do Bloco:</label><input type="text" id="blockName">
<button type="submit">Salvar Bloco</button>
</form>
</section>
<section id="manageUsers">
<h2>Gerenciar Usuários</h2>
<button onclick="showAddUser()">Adicionar Usuário</button>
<div id="userForm" style="display:none;">
<label>Nome:</label><input type="text" id="userName">
<label>Tipo:</label><input type="text" id="userType">
<button onclick="addUser()">Salvar Usuário</button>
</div>
<div id="usersList"></div>
</section>
<script src="https://unpkg.com/@supabase/supabase-js"></script>
<script>
const SUPABASE_URL="https://nqhthypeljupfftlmwsz.supabase.co";
const SUPABASE_KEY="sb_publishable_Nzfhcwd_mFYlzJro3318-g_aX6vGjD1";
const supabaseClient=supabase.createClient(SUPABASE_URL,SUPABASE_KEY);
function showSection(id){document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));document.getElementById(id).classList.add("active")}
let blocks=[];
async function loadBlocks(){let{data,error}=await supabaseClient.from("blocos").select("id,nome");if(error){console.error("Erro carregando blocos",error);return}blocks=data;let fb=document.getElementById("filterBlock");let qb=document.getElementById("questionBlock");fb.innerHTML='<option value="">Todos</option>';qb.innerHTML="";data.forEach(b=>{fb.innerHTML+=`<option value="${b.id}">${b.nome}</option>`;qb.innerHTML+=`<option value="${b.id}">${b.nome}</option>`})}
async function loadQuestions(){let{data,error}=await supabaseClient.from("questoes").select("id,bloco_id,enunciado,correta,comentario,blocos(nome)").order("id");if(error){console.error("Erro carregando questões",error);return}renderQuestions(data)}
function renderQuestions(data){let search=document.getElementById("searchQuestion").value.toLowerCase();let fb=document.getElementById("filterBlock").value;let container=document.getElementById("questionsList");container.innerHTML="";data.filter(q=>(!fb||q.bloco_id===fb)&&(!search||q.enunciado.toLowerCase().includes(search))).forEach(q=>{let div=document.createElement("div");div.innerHTML=`<b>${q.enunciado}</b><br>Resposta: ${q.correta?"Verdadeiro":"Falso"}<br>Comentário: ${q.comentario||""}<br>Bloco: ${q.blocos? q.blocos.nome:"-"}`;container.appendChild(div)})}
document.getElementById("searchQuestion").addEventListener("input",loadQuestions);
document.getElementById("filterBlock").addEventListener("change",loadQuestions);
document.getElementById("questionForm").addEventListener("submit",async e=>{e.preventDefault();let bloco=document.getElementById("questionBlock").value;let en=document.getElementById("questionText").value;let co=document.getElementById("questionComment").value;let ans=document.getElementById("questionAnswer").value==="true";if(!en){alert("Digite a questão");return}let{error}=await supabaseClient.from("questoes").insert([{bloco_id:bloco,enunciado:en,comentario:co,correta:ans}]);if(error){alert("Erro: "+error.message);return}alert("Questão salva!");document.getElementById("questionForm").reset();loadQuestions()});
document.getElementById("blockForm").addEventListener("submit",async e=>{e.preventDefault();let nome=document.getElementById("blockName").value;if(!nome){alert("Digite o nome");return}let{error}=await supabaseClient.from("blocos").insert([{nome}]);if(error){alert("Erro: "+error.message);return}alert("Bloco salvo!");document.getElementById("blockForm").reset();loadBlocks()});function showAddUser(){document.getElementById("userForm").style.display="block"}
async function addUser(){let nome=document.getElementById("userName").value;let tipo=document.getElementById("userType").value;if(!nome||!tipo){alert("Preencha todos os campos");return}let{error}=await supabaseClient.from("usuarios").insert([{nome:nome,tipo:tipo}]);if(error){alert("Erro: "+error.message);return}alert("Usuário adicionado!");document.getElementById("userForm").style.display="none";document.getElementById("userName").value="";document.getElementById("userType").value="";loadUsers()}
async function loadUsers(){let{data,error}=await supabaseClient.from("usuarios").select("id,nome,tipo");if(error){console.error("Erro carregando usuários",error);return}let container=document.getElementById("usersList");container.innerHTML="<table><tr><th>Nome</th><th>Tipo</th><th>Ações</th></tr></table>";let tbl=container.querySelector("table");data.forEach(u=>{let tr=document.createElement("tr");tr.innerHTML=`<td>${u.nome}</td><td>${u.tipo}</td><td><button onclick="deleteUser('${u.id}')">Revogar</button></td>`;tbl.appendChild(tr)})}
async function deleteUser(id){if(!confirm("Revogar este usuário?"))return;let{error}=await supabaseClient.from("usuarios").delete().eq("id",id);if(error){alert("Erro: "+error.message);return}alert("Usuário revogado!");loadUsers()}
window.onload=()=>{loadBlocks().then(()=>loadQuestions());loadUsers();}
</script></body></html>