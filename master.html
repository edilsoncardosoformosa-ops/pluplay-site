<!DOCTYPE html><html lang="pt-BR"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Master Admin</title><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><style>body{font-family:Arial,sans-serif;margin:20px;background:#f9f9f9}h2{margin-top:30px;color:#333}.hidden{display:none}.grid{display:grid;gap:10px;margin-top:10px}.card{background:#fff;padding:15px;border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,.1)}button{padding:6px 12px;border:none;border-radius:5px;background:#007bff;color:#fff;cursor:pointer}button:hover{background:#0056b3}select,input,textarea{padding:6px;border-radius:5px;border:1px solid #ccc;width:100%;margin-top:5px}.actions{display:flex;gap:5px;margin-top:10px}</style></head><body><h1>Painel Master</h1><div><button onclick="showSection('addQuestion')">Adicionar Questão</button><button onclick="showSection('addBlock')">Adicionar Bloco</button><button onclick="showSection('manageUsers')">Gerenciar Usuários</button><button onclick="showSection('manageQuestions')">Gerenciar Questões</button></div><div id="addQuestion" class="hidden card"><h2>Adicionar Questão</h2><input id="qText" placeholder="Digite a questão"><select id="qAnswer"><option value="true">Correta</option><option value="false">Incorreta</option></select><input id="qComment" placeholder="Comentário explicativo"><input id="qTopic" placeholder="Tópico"><button onclick="saveQuestion()">Salvar</button></div><div id="addBlock" class="hidden card"><h2>Adicionar Bloco de Questões</h2><textarea id="blockInput" rows="6" placeholder='Cole o JSON de questões aqui'></textarea><input id="blockTopic" placeholder="Tópico para o bloco"><button onclick="saveBlock()">Salvar Bloco</button><div id="blockStatus"></div></div><div id="manageUsers" class="hidden card"><h2>Gerenciar Usuários</h2><button onclick="addUser()">Adicionar Usuário</button><div id="usersList" class="grid"></div></div><div id="manageQuestions" class="hidden card"><h2>Gerenciar Questões</h2><select id="topicFilter" onchange="renderQuestionsList()"><option value="">Todos os tópicos</option></select><div id="questionsList" class="grid"></div></div><script>const supabaseUrl="https://nqhthypeljupfftlmwsz.supabase.co",supabaseKey="sb_publishable_Nzfhcwd_mFYlzJro3318-g_aX6vGjD1",supabase=window.supabase.createClient(supabaseUrl,supabaseKey);function showSection(id){document.querySelectorAll("div.card").forEach(s=>s.classList.add("hidden")),document.getElementById(id).classList.remove("hidden")}
// Salvar questão única
async function saveQuestion(){let q=document.getElementById("qText").value.trim(),a=document.getElementById("qAnswer").value==="true",c=document.getElementById("qComment").value.trim(),t=document.getElementById("qTopic").value.trim();if(!q||!t)return alert("Preencha todos os campos");let{error:e}=await supabase.from("questoes").insert([{q,a,c,topic:t}]);e?alert("Erro: "+e.message):alert("Questão salva com sucesso!")}
// Salvar bloco JSON
async function saveBlock(){let input=document.getElementById("blockInput").value.trim(),t=document.getElementById("blockTopic").value.trim(),status=document.getElementById("blockStatus");try{let arr=JSON.parse("["+input.replace(/},\s*{/g,"} , {")+"]");if(!Array.isArray(arr))throw new Error("Formato inválido");arr=arr.map(o=>({...o,topic:t}));let{error:e}=await supabase.from("questoes").insert(arr);if(e)throw e;status.innerText="Bloco adicionado com "+arr.length+" questões."}catch(err){status.innerText="Formato inválido JSON: "+err.message}}
// Render usuários
async function renderUserList(){let{data:u,error:e}=await supabase.from("usuarios").select("*");if(e)return console.error(e);let list=document.getElementById("usersList");list.innerHTML="";u.forEach(user=>{let d=document.createElement("div");d.className="card",d.innerHTML="<b>"+user.nome+"</b> ("+user.email+")",list.appendChild(d)})}
async function addUser(){let nome=prompt("Nome do usuário:"),email=prompt("Email:");if(!nome||!email)return;let{error:e}=await supabase.from("usuarios").insert([{nome,email}]);e?alert("Erro: "+e.message):renderUserList()}
// Render questões
async function renderQuestionsList(){let f=document.getElementById("topicFilter").value,{data:q,error:e}=await supabase.from("questoes").select("*");if(e)return console.error(e);if(f)q=q.filter(item=>item.topic===f);let list=document.getElementById("questionsList");list.innerHTML="";q.forEach(item=>{let d=document.createElement("div");d.className="card",d.innerHTML="<b>"+item.q+"</b><br><i>"+item.topic+"</i><div class='actions'><button onclick='editQuestion("+item.id+")'>Editar</button><button onclick='deleteQuestion("+item.id+")'>Excluir</button></div>",list.appendChild(d)})}
// Editar/Excluir questões
async function editQuestion(id){let{data:q,error:e}=await supabase.from("questoes").select("*").eq("id",id).single();if(e)return alert("Erro: "+e.message);let nq=prompt("Questão:",q.q),nc=prompt("Comentário:",q.c),na=confirm("Resposta correta? OK=Sim / Cancelar=Não"),{error:err}=await supabase.from("questoes").update({q:nq,c:nc,a:na}).eq("id",id);err?alert("Erro: "+err.message):renderQuestionsList()}
async function deleteQuestion(id){if(!confirm("Excluir questão?"))return;let{error:e}=await supabase.from("questoes").delete().eq("id",id);e?alert("Erro: "+e.message):renderQuestionsList()}
// Carregar tópicos únicos no filtro
async function loadTopics(){let{data:q,error:e}=await supabase.from("questoes").select("topic");if(e)return console.error(e);let sel=document.getElementById("topicFilter"),t=[...new Set(q.map(i=>i.topic))];t.forEach(tp=>{let opt=document.createElement("option");opt.value=tp,opt.textContent=tp,sel.appendChild(opt)})}
// Inicialização
document.addEventListener("DOMContentLoaded",()=>{renderUserList(),renderQuestionsList(),loadTopics()});</script></body></html>