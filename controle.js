const SUPABASE_URL='https://euankkzzwxpqtdwswfgc.supabase.co',SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5...',supabase=supabase.createClient(SUPABASE_URL,SUPABASE_KEY);let userType=localStorage.getItem('userType')||'demo',userId=localStorage.getItem('userId')||crypto.randomUUID();localStorage.setItem('userId',userId),document.getElementById('userIdBox').value=userId,document.getElementById('waLink').href='https://wa.me/5561999251102?text=Meu%20ID:'+encodeURIComponent(userId),document.getElementById('copyIdBtn').addEventListener('click',()=>{const e=document.getElementById('userIdBox').value;navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).then(()=>alert('ID copiado!')).catch(()=>{const t=document.createElement('textarea');t.value=e,document.body.appendChild(t),t.select();try{document.execCommand('copy')?alert('ID copiado!'):alert('NÃ£o foi possÃ­vel copiar.')}catch(e){alert('Erro ao copiar. Copie manualmente.')}document.body.removeChild(t)}):(()=>{const t=document.createElement('textarea');t.value=e,document.body.appendChild(t),t.select();try{document.execCommand('copy')?alert('ID copiado!'):alert('NÃ£o foi possÃ­vel copiar.')}catch(e){alert('Erro ao copiar. Copie manualmente.')}document.body.removeChild(t)})()}),userType!=='master'&&(document.getElementById('protectedContent').classList.remove('hidden'),document.getElementById('userInfo').classList.remove('hidden'),userType==='demo'&&document.getElementById('demoNote').classList.remove('hidden'));let voiceEnabled=!1;document.getElementById('toggleVoice').onclick=()=>{voiceEnabled=!voiceEnabled,document.getElementById('toggleVoice').classList.toggle('active',voiceEnabled),document.getElementById('toggleVoice').innerText=voiceEnabled?'ðŸ—£ Desativar Ler':'ðŸ—£ Ativar Ler'},document.getElementById('btnManualPassword').onclick=async()=>{const e=prompt('Digite a senha de liberaÃ§Ã£o:');if(!e)return;let{data:t,error:o}=await supabase.from('users').select('note').eq('id','MASTER');o?alert('Erro ao verificar senha.'):data&&data[0]&&data[0].note===e?(alert('Senha correta! Acesso liberado.'),userType='aluno',localStorage.setItem('userType','aluno')):alert('Senha invÃ¡lida. Solicite ao Master a senha correta.')};let quizCurrent=[],currentIndex=0,score=0,maxDemo=5,answeredThis=!1;async function fetchQuiz(e){let{data:t,error:o}=await supabase.from('questions').select('*').eq('topic',e);return o?(alert('Erro ao carregar questÃµes: '+o.message),[]):t.map(e=>({q:e.question,a:e.answer,c:e.comment||''}))}function shuffleArray(e){return e.sort(()=>Math.random()-.5)}async function startQuiz(e){let t=parseInt(document.getElementById('numQuestions').value)||10;quizCurrent=await fetchQuiz(e),'demo'===userType&&(quizCurrent=quizCurrent.slice(0,maxDemo)),quizCurrent=shuffleArray(quizCurrent).slice(0,t),currentIndex=0,score=0,document.getElementById('menu').classList.add('hidden'),document.getElementById('quiz').classList.remove('hidden'),document.getElementById('result').classList.add('hidden'),showQuestion()}function showQuestion(){if(currentIndex>=quizCurrent.length)return endQuiz();const e=quizCurrent[currentIndex];document.getElementById('question').innerText=e.q;const t=document.getElementById('comment');t.innerHTML='',t.style.opacity=0,document.getElementById('counter').innerText=QuestÃ£o ${currentIndex+1} de ${quizCurrent.length},answeredThis=!1,voiceEnabled&&(u=new SpeechSynthesisUtterance(e.q),u.lang='pt-BR',u.rate=1.5,window.speechSynthesis.cancel(),window.speechSynthesis.speak(u))}function answer(e){if(answeredThis)return;answeredThis=!0;const t=quizCurrent[currentIndex],o=document.getElementById('comment');t.a===e?(score++,o.innerHTML=<div class="correct">âœ” VocÃª acertou! ${t.c}</div>):o.innerHTML=<div class="wrong">âœ– VocÃª errou! ${t.c}</div>,o.style.opacity=1,voiceEnabled&&(u=new SpeechSynthesisUtterance(t.a===e?'VocÃª acertou! ':'VocÃª errou! '+t.c),u.lang='pt-BR',u.rate=1.5,window.speechSynthesis.cancel(),window.speechSynthesis.speak(u))}function nextQuestion(){currentIndex++,showQuestion()}function backToMenu(){document.getElementById('quiz').classList.add('hidden'),document.getElementById('result').classList.add('hidden'),document.getElementById('menu').classList.remove('hidden')}function endQuiz(){document.getElementById('quiz').classList.add('hidden'),document.getElementById('result').classList.remove('hidden'),document.getElementById('score').innerText=VocÃª acertou ${score} de ${quizCurrent.length} questÃµes.}function restartQuiz(){currentIndex=0,score=0,document.getElementById('result').classList.add('hidden'),document.getElementById('menu').classList.remove('hidden')}

