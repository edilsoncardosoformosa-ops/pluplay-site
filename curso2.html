<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Prepara√ß√£o Tempor√°rio 2026/2027 ‚Äî Curso 2</title>
<style>
  :root{--p:#1E90FF;--s:#FFA500;--bg:#f4f4f9;--fg:#333}
  body{font-family:Arial,Helvetica,sans-serif;margin:0;background:var(--bg);color:var(--fg)}
  header{background:var(--p);color:#fff;padding:12px 20px;display:flex;align-items:center;justify-content:space-between}
  header img{height:44px}
  main{padding:20px}
  .card{background:#fff;border-radius:10px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06);margin-bottom:16px}
  h1{margin:0 0 8px;font-size:1.25rem}
  button{cursor:pointer;border:0;border-radius:8px;padding:8px 12px;background:var(--p);color:#fff}
  .ghost{background:#eee;color:#222}
  .grid{display:grid;gap:12px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  input,textarea,select{width:100%;padding:8px;border:1px solid #ddd;border-radius:6px}
  label{font-weight:600}
  .muted{color:#666;font-size:.95rem}
  .pill{display:inline-block;padding:4px 8px;background:#eef2ff;border-radius:999px;color:#2563eb}
  .hidden{display:none!important}
  @media(max-width:720px){header{flex-direction:column;align-items:flex-start}}
</style>
</head>
<body>
<header>
  <img src="logomarca.png" alt="Logo Plug & Play">
  <nav aria-label="menu">
    <a href="index.html" style="color:#fff;text-decoration:none;font-weight:700;margin-right:14px">Home</a>
    <span class="muted" style="color:#fff">Curso 2</span>
  </nav>
</header>

<main>
  <div class="card">
    <h1>Prepara√ß√£o Tempor√°rio 2026/2027</h1>
    <p class="muted">Abrange B√°sico e Complementar ‚Äî Milhares de Exerc√≠cios</p>
    <div class="row" style="margin-top:10px">
      <button id="toggleVoice" class="ghost">üîä Ativar Ler</button>
    </div>
  </div>

  <div id="protectedContent" class="card hidden" aria-live="polite">
    <!-- MENU -->
    <div id="menu">
      <label for="numQuestions">Quantas quest√µes?</label>
      <input id="numQuestions" type="number" min="1" max="50" value="10" style="max-width:120px">

      <div class="row" style="margin-top:8px">
        <button onclick="startQuiz('Lport')">L√≠ngua Portuguesa</button>
        <button onclick="startQuiz('ride')">RIDE</button>
        <button onclick="startQuiz('Legisla')">Legisla√ß√£o</button>
        <button onclick="startQuiz('TemaEdu')">Temas Educacionais</button>
        <button onclick="startQuiz('Eduincl')">Educa√ß√£o Inclusiva</button>
      </div>

      <div id="demoNote" class="muted" style="margin-top:8px">‚ö† Demo: at√© <strong>5</strong> quest√µes por t√≥pico se n√£o liberado.</div>
    </div>

    <!-- Quiz -->
    <div id="quiz" class="hidden" style="margin-top:12px">
      <div class="row" style="justify-content:space-between">
        <div id="counter" class="pill"></div>
        <button onclick="backToMenu()" class="ghost">‚Ü© Voltar</button>
      </div>
      <div style="margin-top:10px">
        <div id="question" style="font-size:1.05rem;font-weight:600"></div>
        <div class="row" style="margin-top:10px">
          <button onclick="answer(true)">Certo</button>
          <button onclick="answer(false)" style="background:#dc2626">Errado</button>
        </div>
        <div id="comment" class="muted" style="margin-top:10px"></div>
        <div style="margin-top:12px">
          <button onclick="nextQuestion()">Pr√≥xima quest√£o</button>
        </div>
      </div>
    </div>

    <!-- Result -->
    <div id="result" class="hidden" style="margin-top:12px">
      <h3>Fim do Quiz</h3>
      <p id="score"></p>
      <button onclick="restartQuiz()">Reiniciar</button>
    </div>

    <!-- User info -->
    <div id="userInfo" class="card" style="margin-top:12px">
      <label>ID do dispositivo</label>
      <div class="row">
        <input id="userIdBox" readonly style="max-width:420px">
        <button id="copyIdBtn" class="ghost">üìã Copiar</button>
      </div>
      <div class="muted" style="margin-top:6px">
        Envie seu ID para o Master se precisar liberar acesso completo.
      </div>
    </div>
  </div>
</main>

<script src="controle.js"></script>
<script>
let userId = localStorage.getItem('userId');
if(!userId){ userId = crypto.randomUUID(); localStorage.setItem('userId', userId); }
document.getElementById('userIdBox').value = userId;

let allowedUsers = window.allowedUsers || [];
let quizData = window.quizData || {};
let voiceEnabled = false;
let currentQuestions = [], currentIndex = 0, score = 0;

document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('protectedContent').classList.remove('hidden');

  document.getElementById('toggleVoice').addEventListener('click', () => {
    voiceEnabled = !voiceEnabled;
    document.getElementById('toggleVoice').textContent = voiceEnabled ? 'üîá Desativar Ler' : 'üîä Ativar Ler';
  });

  document.getElementById('copyIdBtn').addEventListener('click', () => {
    navigator.clipboard.writeText(userId).then(()=> alert('ID copiado!'));
  });
});

/* ===== Quiz Functions ===== */
function shuffle(a){ return a.slice().sort(()=>Math.random()-0.5); }

function startQuiz(topic){
  let all = quizData[topic] || [];
  const allowed = allowedUsers.some(u => u.id === userId);
  if(!allowed) all = all.slice(0,5); // demo limit
  if(all.length === 0){ alert('Sem quest√µes neste t√≥pico.'); return; }
  const num = parseInt(document.getElementById('numQuestions').value) || 10;
  currentQuestions = shuffle(all).slice(0,num);
  currentIndex = 0; score = 0;
  document.getElementById('menu').style.display = 'none';
  document.getElementById('quiz').classList.remove('hidden');
  showQuestion();
}

function showQuestion(){
  if(currentIndex >= currentQuestions.length){ endQuiz(); return; }
  const q = currentQuestions[currentIndex];
  document.getElementById('question').textContent = q.q;
  document.getElementById('comment').textContent = '';
  document.getElementById('counter').textContent = `Quest√£o ${currentIndex+1} de ${currentQuestions.length}`;
  if(voiceEnabled){
    const u = new SpeechSynthesisUtterance(q.q);
    u.lang='pt-BR'; u.rate=1.3;
    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(u);
  }
}

function answer(choice){
  const q = currentQuestions[currentIndex];
  const txt = (choice === q.a ? '‚úî Correto! ' : '‚úñ Errado! ') + (q.c || '');
  document.getElementById('comment').textContent = txt;
  if(choice === q.a) score++;
  if(voiceEnabled){
    const u = new SpeechSynthesisUtterance(txt);
    u.lang='pt-BR'; u.rate=1.1;
    window.speechSynthesis.speak(u);
  }
}

function nextQuestion(){ currentIndex++; showQuestion(); }
function backToMenu(){ document.getElementById('quiz').classList.add('hidden'); document.getElementById('menu').style.display='block'; }
function endQuiz(){ 
  document.getElementById('quiz').classList.add('hidden'); 
  document.getElementById('result').classList.remove('hidden'); 
  document.getElementById('score').textContent = `Voc√™ acertou ${score} de ${currentQuestions.length}.`; 
}
function restartQuiz(){ 
  document.getElementById('result').classList.add('hidden'); 
  document.getElementById('menu').style.display='block'; 
}
</script>
</body>
</html>