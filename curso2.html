<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Curso 2</title>
<style>
body{font-family:Arial,sans-serif;margin:0;padding:0;background:#f4f4f9;color:#333}
header{background:#FFA500;color:#fff;padding:12px;text-align:center;cursor:pointer}
.container{padding:12px;max-width:600px;margin:auto}
.card{background:#fff;padding:12px;margin:6px 0;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1)}
button{padding:6px 12px;margin:4px;border:none;border-radius:4px;cursor:pointer}
button.ghost{background:#ccc;color:#333}
.feedback{margin-top:8px;font-weight:bold}
</style>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
<header ondblclick="toggleMaster()">Curso 2</header>
<div class="container">
  <div id="questionContainer"></div>
  <div id="feedback" class="feedback"></div>
  <div style="margin-top:12px">
    Acertos: <span id="score">0</span>
  </div>
</div>

<script>
// ====== Config Supabase ======
const supabaseUrl = 'https://YOUR_SUPABASE_URL';
const supabaseKey = 'YOUR_SUPABASE_ANON_KEY';
const supabase = supabase.createClient(supabaseUrl,supabaseKey);

let questions = [];
let currentIndex = 0;
let score = 0;

// ====== Carregar questões ======
async function loadQuestions(topicFilter='Curso2'){
  const {data,error} = await supabase.from('questions').select('*').eq('topic',topicFilter);
  if(error){ alert('Erro ao carregar questões'); return; }
  questions = data;
  currentIndex = 0;
  score = 0;
  document.getElementById('score').textContent = score;
  showQuestion();
}

// ====== Mostrar questão ======
function showQuestion(){
  const container = document.getElementById('questionContainer');
  container.innerHTML='';
  document.getElementById('feedback').textContent='';
  if(currentIndex>=questions.length){ container.innerHTML='<b>Fim do quiz!</b>'; return; }
  const q = questions[currentIndex];
  speak(q.question); // fala a questão
  const card = document.createElement('div'); card.className='card';
  card.innerHTML=`<b>Pergunta ${currentIndex+1}:</b> ${q.question}`;
  const btnTrue = document.createElement('button'); btnTrue.textContent='Certo';
  const btnFalse = document.createElement('button'); btnFalse.textContent='Errado';
  btnTrue.onclick=()=>checkAnswer(true,q);
  btnFalse.onclick=()=>checkAnswer(false,q);
  card.appendChild(btnTrue); card.appendChild(btnFalse);
  container.appendChild(card);
}

// ====== Checar resposta ======
function checkAnswer(answer,question){
  const feedback = document.getElementById('feedback');
  if(answer===question.answer){
    feedback.textContent='✔ Correto!';
    score++; document.getElementById('score').textContent = score;
  } else {
    feedback.textContent='✖ Errado! '+(question.comment||'');
  }
  currentIndex++;
  setTimeout(showQuestion,800);
}

// ====== Text-to-Speech ======
function speak(text){
  if('speechSynthesis' in window){
    const utter = new SpeechSynthesisUtterance(text);
    window.speechSynthesis.speak(utter);
  }
}

// ====== Toggle master header (para debug ou admin) ======
function toggleMaster(){ alert('Master acessado'); }

// ====== Inicialização ======
loadQuestions();
</script>
</body>
</html>
