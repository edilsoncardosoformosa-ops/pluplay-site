<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Prepara√ß√£o Tempor√°rio 2026/2027 ‚Äî Curso 2</title>
<style>
:root{--p:#1E90FF;--s:#FFA500;--bg:#f4f4f9;--fg:#333}
body{font-family:Arial,Helvetica,sans-serif;margin:0;background:var(--bg);color:var(--fg)}
header{background:var(--p);color:#fff;padding:12px 20px;display:flex;align-items:center;justify-content:space-between}
header img{height:44px}
main{padding:20px}
.card{background:#fff;border-radius:10px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06);margin-bottom:16px}
h1{margin:0 0 8px;font-size:1.25rem}
button{cursor:pointer;border:0;border-radius:8px;padding:8px 12px;background:var(--p);color:#fff}
.ghost{background:#eee;color:#222}
.grid{display:grid;gap:12px}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
input,textarea,select{width:100%;padding:8px;border:1px solid #ddd;border-radius:6px}
label{font-weight:600}
.muted{color:#666;font-size:.95rem}
.pill{display:inline-block;padding:4px 8px;background:#eef2ff;border-radius:999px;color:#2563eb}
.hidden{display:none!important}
@media(max-width:720px){header{flex-direction:column;align-items:flex-start}}
</style>
</head>
<body>
<header>
  <img src="logomarca.png" alt="Logo Plug & Play">
  <nav aria-label="menu">
    <a href="index.html" style="color:#fff;text-decoration:none;font-weight:700;margin-right:14px">Home</a>
    <span class="muted" style="color:#fff">Curso 2</span>
  </nav>
</header>

<main>
  <div class="card">
    <h1>Prepara√ß√£o Tempor√°rio 2026/2027</h1>
    <p class="muted">Abrange B√°sico e Complementar ‚Äî Milhares de Exerc√≠cios</p>
    <div class="row" style="margin-top:10px">
      <button id="toggleVoice" class="ghost">üîä Ativar Ler</button>
      <button id="enterWithPassword" class="ghost">üîê Entrar com senha (se voc√™ recebeu uma)</button>
    </div>
  </div>

  <div id="protectedContent" class="card hidden">
    <div id="menu">
      <label for="numQuestions">Quantas quest√µes?</label>
      <input id="numQuestions" type="number" min="1" max="50" value="10" style="max-width:120px">
      <div class="row" style="margin-top:8px">
        <button onclick="startQuiz('Lport')">L√≠ngua Portuguesa</button>
        <button onclick="startQuiz('ride')">RIDE</button>
        <button onclick="startQuiz('Legisla')">Legisla√ß√£o</button>
        <button onclick="startQuiz('TemaEdu')">Temas Educacionais</button>
        <button onclick="startQuiz('Eduincl')">Educa√ß√£o Inclusiva</button>
      </div>
      <div id="demoNote" class="muted" style="margin-top:8px">‚Ñπ Demo: at√© <strong>5</strong> quest√µes por t√≥pico se n√£o liberado.</div>
    </div>

    <div id="userInfo" class="card hidden" style="margin-top:12px">
      <label>ID do dispositivo</label>
      <div class="row">
        <input id="userIdBox" readonly style="max-width:420px">
        <button id="copyIdBtn" class="ghost">üìã Copiar</button>
      </div>
      <div style="margin-top:6px">
        <label>Contato Master (WhatsApp)</label>
        <a id="waLink" href="#" target="_blank" class="pill">Abrir WhatsApp do Master</a>
      </div>
      <div id="userAllowedNote" style="margin-top:10px"></div>
    </div>

    <!-- Formul√°rio senha -->
    <div id="passwordForm" class="card hidden" style="margin-top:12px">
      <h3>Entrar com senha</h3>
      <label>Senha fornecida pelo Master:</label>
      <input id="studentPassInput" type="password">
      <div class="row" style="margin-top:8px">
        <button id="submitPassBtn">Confirmar</button>
        <button onclick="hidePasswordForm()" class="ghost">Cancelar</button>
      </div>
    </div>
<script>
// ===== Inicializa√ß√£o =====
let userId = localStorage.getItem('userId');
if(!userId){ userId = Date.now().toString(); localStorage.setItem('userId', userId); }
let allowedUsers = JSON.parse(localStorage.getItem('allowedUsers') || '[]'); // array de objetos {id,note}
let questions = JSON.parse(localStorage.getItem('questions') || '{}');
if(Object.keys(questions).length === 0){
  questions = {
    Lport:[{q:"Na corre√ß√£o de reda√ß√µes, compreender o sentido literal das palavras √© o primeiro passo.",a:true,c:"Correto."}],
    ride:[{q:"O Distrito Federal est√° na regi√£o Centro-Oeste.",a:true,c:"Correto."}],
    Legisla:[{q:"A educa√ß√£o √© direito de todos e dever do Estado e da fam√≠lia.",a:true,c:"Art.205 CF/88"}],
    TemaEdu:[{q:"O planejamento educacional √© processo cont√≠nuo e sistem√°tico.",a:true,c:"Correto."}],
    Eduincl:[{q:"Todos os alunos t√™m direito √† educa√ß√£o inclusiva.",a:true,c:"Correto."}]
  };
  localStorage.setItem('questions', JSON.stringify(questions));
}

let isMaster = false;
let voiceEnabled = false;
let currentQuestions = [], currentIndex = 0, score = 0;

// ===== Eventos DOM =====
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('protectedContent').classList.remove('hidden');
  document.getElementById('userIdBox').value = userId;
  document.getElementById('waLink').href = 'https://wa.me/5561999251102?text=Meu%20ID:%20'+encodeURIComponent(userId);

  // Mostrar se usu√°rio j√° liberado
  const allowedObj = allowedUsers.find(u=>u.id===userId);
  if(allowedObj){
    document.getElementById('userInfo').classList.remove('hidden');
    document.getElementById('userAllowedNote').innerHTML = `<strong style="color:green">Acesso liberado!</strong><div class="muted">Nota: ${allowedObj.note||''}</div>`;
  } else {
    document.getElementById('userInfo').classList.remove('hidden');
  }

  // copiar ID
  document.getElementById('copyIdBtn').addEventListener('click', ()=> {
    navigator.clipboard.writeText(userId).then(()=> alert('ID copiado!'));
  });

  // alternar voz
  document.getElementById('toggleVoice').addEventListener('click', ()=>{
    voiceEnabled = !voiceEnabled;
    document.getElementById('toggleVoice').textContent = voiceEnabled ? 'üîá Desativar Ler' : 'üîä Ativar Ler';
  });

  // abrir formul√°rio senha
  document.getElementById('enterWithPassword').addEventListener('click', ()=> {
    document.getElementById('passwordForm').classList.remove('hidden');
  });

  // enviar senha
  document.getElementById('submitPassBtn').addEventListener('click', async ()=>{
    const pass = document.getElementById('studentPassInput').value.trim();
    if(!pass) return alert("Senha n√£o informada.");
    const stored = localStorage.getItem('studentPassHash');
    if(!stored) return alert("Ainda n√£o existe senha definida pelo Master.");
    const hash = await sha256(pass);
    if(hash === stored){
      if(!allowedUsers.some(u=>u.id===userId)){
        allowedUsers.push({id:userId,note:'Liberado via senha'});
        localStorage.setItem('allowedUsers', JSON.stringify(allowedUsers));
      }
      alert("Acesso liberado com sucesso!");
      document.getElementById('passwordForm').classList.add('hidden');
      document.getElementById('userAllowedNote').innerHTML = `<strong style="color:green">Acesso liberado!</strong>`;
    } else alert("Senha incorreta.");
  });
});

// ===== SHA-256 =====
async function sha256(text){
  const enc = new TextEncoder();
  const buf = await crypto.subtle.digest('SHA-256', enc.encode(text));
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
}

// ===== Quiz =====
function startQuiz(topic){
  let all = questions[topic]||[];
  const allowed = allowedUsers.some(u=>u.id===userId);
  if(!isMaster && !allowed) all = all.slice(0,5);
  const num = parseInt(document.getElementById('numQuestions').value)||10;
  currentQuestions = all.slice(0,num);
  currentIndex=0; score=0;
  document.getElementById('menu').style.display='none';
  document.getElementById('quiz').classList.remove('hidden');
  showQuestion();
}

function showQuestion(){
  if(currentIndex>=currentQuestions.length){ endQuiz(); return; }
  const q = currentQuestions[currentIndex];
  document.getElementById('question').textContent = q.q;
  document.getElementById('comment').textContent='';
  document.getElementById('counter').textContent=`Quest√£o ${currentIndex+1} de ${currentQuestions.length}`;
  if(voiceEnabled){
    const u = new SpeechSynthesisUtterance(q.q);
    u.lang='pt-BR'; u.rate=1.3; window.speechSynthesis.cancel(); window.speechSynthesis.speak(u);
  }
}

function answer(choice){
  const q = currentQuestions[currentIndex];
  const txt = (choice===q.a?'‚úî Correto! ':'‚ùå Errado! ') + (q.c||'');
  document.getElementById('comment').textContent = txt;
  if(choice===q.a) score++;
  if(voiceEnabled){
    const u = new SpeechSynthesisUtterance(txt);
    u.lang='pt-BR'; u.rate=1.1; window.speechSynthesis.speak(u);
  }
}

function nextQuestion(){ currentIndex++; showQuestion(); }
function backToMenu(){ document.getElementById('quiz').classList.add('hidden'); document.getElementById('menu').style.display='block'; }
function endQuiz(){ 
  document.getElementById('quiz').classList.add('hidden'); 
  document.getElementById('result').classList.remove('hidden'); 
  document.getElementById('score').textContent = `Voc√™ acertou ${score} de ${currentQuestions.length}.`; 
}
function restartQuiz(){ 
  document.getElementById('result').classList.add('hidden'); 
  document.getElementById('menu').style.display='block'; 
}

// ===== utilit√°rios =====
function hidePasswordForm(){ document.getElementById('passwordForm').classList.add('hidden'); }

</script>
</body>
</html>