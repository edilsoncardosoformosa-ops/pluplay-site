const MASTER_HASH="50d14563b2f686e9f88f93f7ff37f1a048bb49e2746b1c90502f83510c7e1b6c";async function sha256(t){const e=new TextEncoder,n=await crypto.subtle.digest("SHA-256",e.encode(t));return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}function loadAllowedUsers(){try{const t=localStorage.getItem("allowedUsers")||"[]",e=JSON.parse(t);return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]?JSON.parse(localStorage.setItem("allowedUsers",JSON.stringify(e.map(t=>({id:t,note:""})))),JSON.stringify(e.map(t=>({id:t,note:""})))):Array.isArray(e)?e:[]}catch(t){return[]}}function saveAllowedUsers(t){localStorage.setItem("allowedUsers",JSON.stringify(t))}let allowedUsers=loadAllowedUsers(),userId=localStorage.getItem("userId");userId||(userId=crypto.randomUUID(),localStorage.setItem("userId",userId));let questions=JSON.parse(localStorage.getItem("questions")||"{}");0===Object.keys(questions).length&&(questions={Lport:[{q:"Na correção de redações, compreender o sentido literal das palavras é o primeiro passo.",a:!0,c:"Correto."}],ride:[{q:"O Distrito Federal está na região Centro-Oeste.",a:!0,c:"Correto."}],Legisla:[{q:"A educação é direito de todos e dever do Estado e da família.",a:!0,c:"Correto, art.205 CF/88."}],TemaEdu:[{q:"O planejamento educacional é processo contínuo e sistemático.",a:!0,c:"Correto."}],Eduincl:[{q:"Todos os alunos têm direito à educação inclusiva.",a:!0,c:"Correto."}]},localStorage.setItem("questions",JSON.stringify(questions));let voiceEnabled=!1,currentQuestions=[],currentIndex=0,score=0;document.addEventListener("DOMContentLoaded",async()=>{document.getElementById("protectedContent").classList.remove("hidden"),document.getElementById("userIdBox").value=userId,document.getElementById("waLink").href="https://wa.me/5561999251102?text="+encodeURIComponent("Meu ID: "+userId),document.getElementById("copyIdBtn").addEventListener("click",()=>{navigator.clipboard.writeText(userId).then(()=>alert("ID copiado!"))}),document.getElementById("toggleVoice").addEventListener("click",()=>{voiceEnabled=!voiceEnabled,document.getElementById("toggleVoice").textContent=voiceEnabled?"ðŸ”ˆ Desativar Ler":"ðŸ”Š Ativar Ler"}),document.getElementById("enterWithPassword").addEventListener("click",async()=>{const t=document.getElementById("studentPassInput")?document.getElementById("studentPassInput").value.trim():prompt("Digite a senha de aluno:");if(!t)return alert("Senha não informada.");const e=localStorage.getItem("studentPassHash");if(!e)return alert("Ainda não existe senha definida.");const n=await sha256(t);n===e?(allowedUsers.some(t=>t.id===userId)||allowedUsers.push({id:userId,note:"Liberado via senha"}),saveAllowedUsers(allowedUsers),document.getElementById("userInfo").innerHTML='Acesso liberado! <br>Contato Master: <a href="https://wa.me/5561999251102" target="_blank">+55(61)99925-1102</a>',alert("Acesso liberado!")):alert("Senha incorreta.")});const t=document.getElementById("numQuestions");["Lport","ride","Legisla","TemaEdu","Eduincl"].forEach(e=>{document.querySelector("button[onclick*='"+e+"']").addEventListener("click",()=>startQuiz(e))}),renderUserInfo(),renderQuiz()});function renderUserInfo(){const t=allowedUsers.find(t=>t.id===userId);t?document.getElementById("userAllowedNote").innerHTML='<strong style="color:green">Acesso liberado!</strong><div class="muted">'+(t.note||"")+"</div>":document.getElementById("userInfo").classList.remove("hidden")}function shuffle(t){return t.slice().sort(()=>Math.random()-.5)}function startQuiz(t){let e=questions[t]||[];const n=allowedUsers.some(t=>t.id===userId);n||(e=e.slice(0,5));if(0===e.length)return alert("Sem questões neste tópico.");const i=parseInt(document.getElementById("numQuestions").value)||10;currentQuestions=shuffle(e).slice(0,i),currentIndex=0,score=0,document.getElementById("menu").style.display="none",document.getElementById("quiz").classList.remove("hidden"),showQuestion()}function showQuestion(){if(currentIndex>=currentQuestions.length)return endQuiz();const t=currentQuestions[currentIndex];document.getElementById("question").textContent=t.q,document.getElementById("comment").textContent="",document.getElementById("counter").textContent="Questão "+(currentIndex+1)+" de "+currentQuestions.length),voiceEnabled&&(window.speechSynthesis.cancel(),window.speechSynthesis.speak(new SpeechSynthesisUtterance(t.q)))}function answer(t){const e=currentQuestions[currentIndex],n=(t===e.a?"✔ Correto! ":"✖ Errado! ")+e.c;document.getElementById("comment").textContent=n,t===e.a&&score++,voiceEnabled&&(window.speechSynthesis.cancel(),window.speechSynthesis.speak(new SpeechSynthesisUtterance(n)))}function nextQuestion(){currentIndex++,showQuestion()}function backToMenu(){document.getElementById("quiz").classList.add("hidden"),document.getElementById("menu").style.display="block"}function endQuiz(){document.getElementById("quiz").classList.add("hidden"),document.getElementById("result").classList.remove("hidden"),document.getElementById("score").textContent="Você acertou "+score+" de "+currentQuestions.length+"."}function restartQuiz(){document.getElementById("result").classList.add("hidden"),document.getElementById("menu").style.display="block"}function renderQuiz(){document.getElementById("quiz")&&showQuestion()}